spec_version: 2
inputs:
  namespace:
    type: string
    default: quali
  network:
    type: string
    default: 'network-{% assign random_number = "now" | date: "%N" | modulo: 15000 | plus: 0 %}'
outputs:
  network-name:
    value: '{{ .inputs.namespace }}/{{ .inputs.network }}'
grains:
  network:
    kind: helm
    spec:
      agent:
        name: openshift-agent
      source:
        store: torque-tf-blueprints
        path: helm/k8s-deploy-network
      command-arguments: '--timeout 65m'
      inputs:
        - network: '{{ .inputs.network }}'
        - namespace: '{{ .inputs.namespace }}'
      # scripts:
      #   post-helm-install:
      #     source:
      #       store: torque-tf-blueprints
      #       path:  scripts/get_network_state.sh
      #     arguments: '{{ .inputs.namespace }}'
      #     outputs:
      #       - network_name